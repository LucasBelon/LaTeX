\documentclass[a4paper, 12pt]{article}

\input{./preambulo.tex}

\begin{document}

\input{./maketitle.tex}

\input{./sumario.tex}


%---------Estilos Próprios---------------+
\newcommand{\vimcommand}[1]{%
    \sethlcolor{black}%
    \textbf{\textcolor{white}{\hl{#1}}}%
}
\newcommand{\vimkeys}[1]{%
    \sethlcolor{black}%
    \textbf{\textcolor{red}{\hl{#1}}}%
}
%----------------------------------------+

% TODO: Encontrar uma imagem para adicionar na capa.
%\thispagestyle{empty}
%\setcounter{page}{-1}
%\thispagestyle{empty}

% Primeiro Capítulo
\include{motivacao.tex}

% Segundo Capítulo
\include{introducao.tex}

% Terceiro Capítulo
\section{Recursos avançados}
A maior parte do básico está feito.
Você sabe escrever, sabe apagar, sabe trocar palavras de lugar, copiando e colando.
Já aprendeu a pular dentro de um arquivo, fazendo já parecer bruxaria. Mas até agora
estamos no reino iluminado, em que um iniciante observar e entender o que está acontecendo.
Eu diria que a partir vamos mexer com magia negra, que se faltar atenção, acontecerão coisas num piscar de olhos
que não terão uma explicação razoável.
Por isso, a partir daqui, teste tudo, crie você mesmo experimentos

Vamos começar falando sobre como procurar e substituir termos num arquivo e
como podemos substituir múltiplos termos de uma só vez.
Na sequência, veremos o que são os registros, e para onde vão os trechos de código que apagamos.

Então vamos começar a usar múltiplos arquivos e executar ações neles.
Organizar janelas para obter uma boa visualização, além de montar e manter um layout eficiente.

\subsection{Busca No Arquivo}
Buscar dentro do arquivo é relativamente simples.
Basta usar o comando \vimcommand{/} e pesquisar o que você deseja procurar.
Se for encontrado o termo, seu cursor será jogado para cima dele.
Outras ocorrências da busca ficarão destacadas, e não sumirão até se executar o comando
\vimcommand{:nohlsearch}, ou a versão reduzida \vimcommand{:noh}. 

Para avançar entre os termos encontrados na busca, use o comando \vimcommand{n} para avançar para frente.
Para retroceder, buscando termos anteriores, use \vimcommand{N}.
Na régua inferior podem aparecer informações importantes do tipo, "Sua busca chegou ao fim do arquivo, recomeçando do começo",
vale a pena ficar de olho.

Podemos realizar buscas no sentido inverso do arquivo com \vimcommand{?}, que terá os mesmos impactos que a busca normal.
Caso você queira buscar um termo que esteja sob o cursor, pode-se utilizar \vimcommand{\#},
que o mesmo efeito de se utilizar a busca com \vimcommand{/} ocorrerá. 
Para se buscar o termo sob o cursor, mas no sentido inverso, vale o comando \vimcommand{*}.

Se você realizou uma busca e deseja repetí-la, \vimcommand{//}, e o mesmo vale para \vimcommand{??}.

Apesar de podermos pesquisar termos simples, podemos utilizar expressões regulares para encontrar padrões que se casam com nossas especificações.
Este é um texto sobre vim, não sobre REGEX, então, se quiser, vá atrás por conta.

\subsection{Substituição No Arquivo}
Quando estamos programando temos o costume de usar vastamente palavras chave.
A repetição de palavras chave é muito grande, seja para nomear variáveis, seja para nomear funções,
ou mesmo uma informação escrita à força, ou \textit{hardcoded}.
Você pode realizar a substituição de diversas formas diferentes.
Como você já sabe realizar a busca, basta encontrar e substituir uma a uma.
Mas se você deseja fazer de uma forma automática, que abrange de uma ocorrência, a múltiplas delas, então esse comando é pra você.

Para realizar uma substituição de uma ocorrência, na linha atual, pode-se usar:\\
\vimcommand{:s/ocorr/subst}.
Perceba que você precisa estar com o cursor na linha alvo da substituição.
Se sua substituição tem como alvo todas as ocorrências de \textit{ocorr}, então,
com o cursor posicionado na linha alvo, \vimcommand{:s/ocorr/{subst}/g} dirá ao comando que
você deseja aplicar as substituições globalmente, alterando todas as ocorrências.

Para trabalhar com um escopo definido de linhas, existem duas formas: A primeira,
definir em quais linhas do arquivo a substituição ocorrerá.
Nesse formato fazemos \\
\vimcommand{:4,12s/ocorr/subst},
podendo aplicar na primeira ocorrência, ou em todas elas adicionando \vimcommand{g} ao final.
Neste exemplo, o escopo será da linha 4 à linha 12.

Uma outra forma de definir o escopo é selecionar com o modo visual o trecho
que sofrerá alteração.
Temos um pouco mais de flexibilidade neste caso, podendo selecionar pedaços de linha,
linhas inteiras,
blocos de texto\ldots\
E então, basta aplicar o comando.

Se quisermos que o escopo seja o arquivo inteiro, em todas as ocorrências, usamos \vimcommand{:\%s/ocorr/subst/g}.
O termo \% simboliza o próprio arquivo no vim, seja seu nome, seja seu texto como este caso.

Para terminarmos sobre substuições, para que sejamos perguntados se queremos ou não substituir o termo de ocorrência:
\vimcommand{:\%s/ocorr/subst/gc}, o termo \vimcommand{c} adicionado é quem faz o serviço.

\subsection{Folds}
Existem casos em que você tem um parágrafo que deseja colapsar, ou seja, deixá-lo numa única linha para poder visualizar o restante.
Isso é útil para verificar a consistência do formato geral do texto, e para poder, por exemplo, verificar se todos os assuntos foram abrangidos.

Pessoalmente, acho raro utilizar, e difícil de configurar.
Mas caso você esbarre numa sequência de teclas estranhas, então melhor saber desfazer essas alterações.

A lista de teclas de ação são:
\begin{itemize}
    \item \vimcommand{zc} - Fechar uma dobradura.
    \item \vimcommand{zo} - Abrir uma dobradura.
    \item \vimcommand{zM} - Fechar todas as dobraduras.
    \item \vimcommand{zR} - Abrir todas as dobraduras.
    \item \vimcommand{za} - Abrir ou Fechar dobraduras.
\end{itemize}

Agora, se você fechou uma dobradura de texto, então sabe abrir.
Existem muitos métodos para identificar uma possível dobradura que faça sentido.
Existem os métodos: \textit{indent}, \textit{diff}, \textit{syntax}, \textit{expr}, \textit{manual} e \textit{marker}

Uma rápida explicação sobre o modo manual.
Você seleciona uma quantidade de texto, com o modo visual, e usa o comando \vimcommand{:fold}.
Então você habilitou o trecho do texto a ser dobrável.
Eu considero uma forma trabalhosa, mas extremamente versátil.

\subsection{Registers}
Os registros do vim são os slots de memória de elementos salvos e deletados.
Nestes slots podem haver todos os tipos de informações.
Trata-se de conteúdo apagado, o clipboard do vim, nome do arquivo atual, do arquivo anteriormente aberto,
e macros, que são o conteúdo a seguir.

Para uma primeira experiência sobre os registros, vamos salvar um trecho de texto
em um slot específico: \vimcommand{"ax}, este comando irá ativar o registro \vimcommand{a}, e
o utilizará para armazenar o caractere que será apagado com o comando \vimcommand{x}.

Para colar um trecho de texto desse slot, o comando é parecido: \vimcommand{"aP}.
Perceba que escolhi utilizar o P maiúsculo, simplesmente para poder desfazer as alterações causadas pelo comando anterior.
Você pode visualizar quais registros estão sendo utilizados e seu conteúdo usando o comando \vimcommand{:registers}.
Se você vir caracteres esquisitos como \vimkeys{$<$80$>$} ou \vimkeys{\^}\vimkeys{M}, saiba que são caracteres especiais como 
enter, esc, ctrl-M, etc.
No meu vim em específico, como eu tenho algumas macros definidas, as ações de teclas especiais ficam salvas neste formato,
portanto, o vim possui um método próprio de armazenar caracteres de ação especiais.

\subsection{Macros}
Macros fazem parte de um conjunto mágico de ferramentas que o vim possui.
Existem, para os editores de código, plugins para poder se aproveitar da movimentação que o vim oferece.
E de fato é muito bom poder se mover, saltar, salvar e fechar determinados arquivos.
Mas as macros são uma ferramenta muito específica, muito poderosa, que dificilmente pode ser imitada por um plugin.

Macros armazenam sequências de ações, sejam comandos, sejam inserção de texto, deleção ou substituição.
Literalmente qualquer coisa pode ser armazenada. Então, basta ativar a macro e sua ação será re-executada.

Vamos fazer um teste super simples.
A partir do modo normal pressione \vimcommand{q} e uma tecla para ser usada como registro.
No rodapé da janela você verá algo como \textit{"recording @a"}, que mostra que você está gravando
uma macro no registro "a".
Tecle novamente \vimcommand{q} para interromper a gravação.

Para testar, vamos fazer o seguinte:\vimcommand{qa0x\$xjq}.
Abrimos a gravação \vimcommand{q}, atribuímos o registro \vimcommand{a},
pedimos que retorne para o começo da linha \vimcommand{0}, que delete um caractere
\vimcommand{x}, que então pule para o fim da linha \vimcommand{\$}
e delete um caractere novamente \vimcommand{x}, e então descemos uma linha \vimcommand{j},
para enfim, encerrarmos a gravação \vimcommand{q}.

Difícil acompanhar por texto, mas super simples de executar.
E talvez o mais importante, simples de replicar.
Para repetir esse conjunto de ações, selecione o número de repetições e use \vimcommand{$@$a}.
Essa macro deleta o primeiro e último caractere de uma linha e então pula para a linha seguinte.
Se você quisesse, por exemplo, deletar a primeira palavra de um conjunto de linhas, como faria?
Se a respostas for "à mão", então você está perdendo tempo e desperdiçando o potencial da ferramenta.

Para gravar macros, podemos utilizar dois tipos de operação.
Podemos sobrescrever um registro, que é o que fizemos no exemplo, mas podemos também adicionar novos comandos.
Ao usar \vimcommand{qAdiwjq}, estamos adicionando um "delete inner word" e um descer linha à macro salva no registro a.
Verifique com o comando \vimcommand{:registers} suas macros de teste.

Caso não tenha ficado claro, como as macros são armazenadas em um registro, podemos colá-las com \vimcommand{"aP}.
Isso será útil.

Quando falarmos de arquivos de configuração, o famoso vimrc, poderemos simplesmente colar nossa macro lá.
Dessa forma, teremos nossas macros sempre disponíveis, e poderemos criar macros cada vez mais elaboradas.
Pessoalmente possuo macros que servem de atalho para alguns comandos, outras para alteração de layout,
que é um tópico futuro, e uma com uma sequência de texto pré-definido.
O ponto negativo é gastar os slots, mas são muitos, e você pode simplesmente desativar essas configurações
futuramente, ou mesmo sobrescrever com um vazio.

\subsection{O Que É Um Buffer}
Quando programamos e precisamos reservar uma quantidade de memória do computador, declaramos um buffer.
Basicamente, se trata de uma quantidade de memória reservada para operação.
Abrir arquivos é uma operação que requer um buffer, já que realizar alterações pequenas diretamente em arquivo
não é a melhor das ideias.
A estratégia é trazer para memória, alterar o trecho, e devolver as alterações.

Quando você abre um arquivo, o vim cria um buffer.
Esse buffer representa seu arquivo.
Quando você salva, ele escreve as alterações no arquivo original.
E o mais importante, ninguém disse que não poderiam haver mais de um buffer.
Ou seja, vamos começar a abrir e editar mais de um arquivo por vez!

% CONTINUA AQUI --------------------------------------------------------------------------
\subsection{Operando Com Múltiplos Arquivos}
Abrindo múltiplos arquivos pela linha de comando: vim arquivo1.txt arquivo2.tex arquivo3.c
badd
bdelete
bnext
bprevious
blast

\subsubsection{bufdo, Rodando Comandos Em Múltiplos Arquivos}
Podemos realizar substituições em conjuntos de arquivos, rodar macros, realizar
buscas.
\ldots
\subsection{MultiWindows}
Como abrir múltiplas janelas
Como mover múltiplas janelas
Como redimensionar as múltiplas janelas
Como fechar janelas, e apagar o buffer.
...
\subsubsection{Save View}
Ser curto na explicação.
...
\subsection{MultiTabs}
Como criar, como navegar, como mover, abrindo o terminal dentro do vim.
Como desativar o terminal e ver inputs antigos.
...
\subsubsection{Save Session}
Como criar, porquê nem sempre é uma boa ideia, e como podemos usar para abrir um projeto
...
\subsection{Quickfix Com Grep}
...

\newpage
\section{Settings}
...
\subsection{Onde Estão Minhas Configurações}
...
\subsection{Abreviações}
...
\subsection{Salvando Macros}
...
\subsection{Olhando um arquivo vimrc pré-pronto}
...

\newpage
\section{Plugins Built-in}
...

\newpage
\section{Escolhendo e gerenciando Plugins}
...

\newpage
\section{Usando o Manual}
...

\newpage
\section{Usos diversos}
\subsection{PairProgramming com tmux}
\ldots
\subsection{Usando ssh-keys para editar arquivos remotos usando o meu vim}
\ldots
\subsection{Criando um layout semelhante à uma IDE (meu @i) com o vim padrão}
\ldots

\end{document}
